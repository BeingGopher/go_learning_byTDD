# 高频问题

## 分布式服务接口的幂等性如何设计 

所谓幂等性，就是说一个接口，多次发起同一个请求，你这个接口得保证结果 是准确得。比如不能多扣
款。不能多插入一条数据，不能将统计值多加了 1， 这就是幂等性。 其实保证幂等性主要是三点：

1. 对于每个请求必须有一个唯一的标识，举个例子：订单支付请求，肯定得 包含订单 ID，一个订单 
ID 最多支付一次  
2. 每次处理完请求之后，必须有一个记录标识这个请求处理过了，比如说常 见得方案是再 MySQL 中
记录个状态啥得，比如支付之前记录一条这个订单 得支付流水，而且支付流水采用 order id 作为唯
一键（unique key）。只 有成功插入这个支付流水，才可以执行实际得支付扣款  
3. 每次接收请求需要进行判断之前是否处理过得逻辑处理，比如说，如果有 一个订单已经支付了，就
已经有了一条支付流水，那么如果重复发送这个 请求，则此时先插入支付流水，order id 已经存在
了，唯一键约束生效， 报错插入不进去得。然后你就不用再扣款了 

## 你了解业界哪些大公司的分布式锁框架

京东：SharkLock 是基于 Redis 实现的分布式锁。锁的排他性由 SETNX 原语实现，使 用 timeout 与续租机制
实现锁的强制释放 