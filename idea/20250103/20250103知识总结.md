# 20250103知识总结

## 1.KMP算法关于next数组的实现

> 找到冲突的位置后，指针回退到冲突前next指针指向的元素（-1），该元素作为下标

### 1.1初始化（函数数组等）

j：指向前缀末尾的位置 && i之前（包括i）的最长相等前后缀的长度

i：指向后缀末尾

```go
func getNext(next []int, s string) {
    var next []int{}
	j := 0
	next[0] = 0
	for i := 1; i < len(s); i++ {
    	//逻辑
	}
}
```

### 1.2前后缀不同的情况

当s[j] != s[i]时，也就是匹配冲突，j需要回退，回退的逻辑为：看前一位的next数组的**值**（注意是值不是下标），这个值就是j要回退到的下标。

> [!CAUTION]
>
> 条件不能是if，因为冲突是需要连续回退的（如果一直不相等的话）

```go
for j > 0 && s[i] != s[j] {//当j回退到0的时候就到了初始位置，停止回退
    j = next[j-1]
}
```

### 1.3前后缀相同的情况

当相等的时候，对于j的操作应该是加一。除了因为指针位置需要更新，还因为j有另一层身份：**i之前的最长相等前后缀长度（包括i）**

```go
if s[i] == s[j] {
    j++
}


```

### 1.4更新next数组

```go
next[i] = j//i之前的最长相等前后缀长度（包括i）
```

## 2.字符串相关的知识积累

> 做这一个小章节主要是因为自己最近做字符串相关的练习时，对于各种类型的转换始终拿捏不住，导致代码很多时候不是因为思路出现问题报错，遂做一个小总结，加深印象。

### 2.1比较

在go中，rune、string、[]byte都可以来一定程度上表示字符串。

其中：

> `string` 是Go语言中的一种内建数据类型，用于表示文本。它是不可变的；

> `[]byte` 是一个字节切片，它是Go语言中处理二进制数据或者需要修改字符串内容的最常用的数据类型。字节切片可以被修改；

> `rune` 是 Go 语言中的一种类型，用于表示单个 Unicode 字符。`rune` 实际上是 `int32` 的别名，它表示的是字符的 Unicode 码点（code point），而不是字符的字节序列。

* 对于string而言：

  * **特点**：

    - **不可变性**：一旦创建了一个字符串，其内容不能被改变。如果你对一个字符串进行修改或拼接，实际上会创建一个新的字符串，而原字符串不受影响。
    - **存储方式**：Go中的字符串是一个只读的字节切片（`[]byte`）。它的内部表示可以理解为一个只读的`[]byte`，但它不能像`[]byte`那样直接修改。
    - **支持UTF-8**：Go中的字符串是UTF-8编码的，这意味着它支持几乎所有世界语言的字符，包括英语、中文、日文、表情符号等。

    **使用场景**：

    - 最常见的字符串类型，适用于大多数文本处理场景。
    - 如果不需要对字符串内容进行修改，或者需要表示静态文本，使用`string`是最合适的。
    - 在Go中，`string`类型是一个值类型。它的每个实例包含一个**指向底层数组的指针**，因此在内存中有一定的开销。

* 对于[]byte而言：

  * **特点**：

    - **可变性**：`[]byte` 是一个可变的数据类型，你可以随时修改字节切片中的数据内容。这意味着可以用它来处理需要修改内容的文本数据。
    - **存储方式**：`[]byte` 是一个动态数组，可以容纳任意数量的字节，适用于表示二进制数据或者需要修改的字符串内容。
    - **与字符串的转换**：Go中字符串和字节切片之间的转换非常常见。你可以使用 `[]byte()` 将字符串转换为字节切片，或者使用 `string()` 将字节切片转换为字符串。

    **使用场景**：

    - 适用于处理二进制数据、网络数据、文件读写等场景。
    - 在需要修改字符串内容时，通常会使用字节切片来代替字符串。

* 对于rune而言：

  * **特点**：

    - **表示Unicode字符**：`rune` 可以表示所有的 Unicode 字符，包括 ASCII 字符、汉字、表情符号等。它是一个 32 位的整数，用来存储字符的 Unicode 码点。
    - **字符支持**：与 `string` 和 `[]byte` 不同，`rune` 是单一字符的表示，不考虑字符的编码。每个 `rune` 代表一个 Unicode 字符。
    - **大小**：`rune` 的大小固定为 4 字节（即 32 位），足以表示所有的 Unicode 字符。

    **使用场景**：

    - 当你需要逐个处理字符串中的字符，特别是多字节字符（如汉字、表情符号等）时，`rune` 是理想的选择。
    - 如果需要在字符串中访问或操作单个字符，使用 `rune` 会更准确，因为它表示整个字符，而不仅仅是字节。

> [!CAUTION]
>
> 虽然 Go 中的字符串是基于 UTF-8 编码的，但 `rune` 表示的是 Unicode 码点。UTF-8 编码的字符可能由多个字节组成，而 `rune` 可以确保你处理的是一个完整的字符。

### 2.2**总结：`string`、`[]byte` 和 `rune` 的区别与联系**

| 特性         | `string`                                     | `[]byte` (字节切片)                        | `rune`                                     |
| ------------ | -------------------------------------------- | ------------------------------------------ | ------------------------------------------ |
| **定义**     | 表示UTF-8编码的不可变字符序列                | 表示字节切片，通常用于二进制数据或修改内容 | 表示Unicode字符的码点，实际是`int32`的别名 |
| **存储方式** | 底层是只读的字节切片                         | 可变字节数组                               | 存储Unicode码点，固定32位                  |
| **可变性**   | 不可变                                       | 可变                                       | 不可变（每个`rune`代表一个字符）           |
| **适用场景** | 适用于文本处理，表示不可变的文本             | 适用于需要修改字符串内容或处理二进制数据   | 适用于处理Unicode字符，特别是多字节字符    |
| **转换**     | 可以转为`[]byte`或通过`string()`转换为`rune` | 可以通过`string()`转换为字符串             | 可以通过`string()`转换为`rune`             |
| **字节数**   | 1到4个字节（UTF-8编码）                      | 任意字节数                                 | 固定4字节（32位）                          |

### 2.3循环遍历上的一些差异

#### 1. **遍历 `string`**

Go 中的 `string` 是 UTF-8 编码的字节序列，当你使用 `range` 来遍历 `string` 时，**`range`** 会按 Unicode 字符（而不是按字节）来遍历字符串。这意味着它会将每个字符作为一个 **`rune`** 来处理，`rune` 代表 Unicode 字符的码点。

- 遍历时返回的值

  ：

  - **索引（`int` 类型）**：当前字符在字符串中的字节位置（按 UTF-8 编码的字节）。
  - **字符（`rune` 类型）**：字符串中的当前字符（即 Unicode 码点）。

示例：遍历 `string`

```go
str := "Hello, 世界 🌍"
for i, ch := range str {
    fmt.Printf("Index: %d, Character: %c (Unicode: %U)\n", i, ch, ch)
}
```

**输出**：

```yaml
Index: 0, Character: H (Unicode: U+0048)
Index: 1, Character: e (Unicode: U+0065)
Index: 2, Character: l (Unicode: U+006C)
Index: 3, Character: l (Unicode: U+006C)
Index: 4, Character: o (Unicode: U+006F)
Index: 5, Character: , (Unicode: U+002C)
Index: 6, Character:   (Unicode: U+0020)
Index: 7, Character: 世 (Unicode: U+4E16)
Index: 10, Character: 界 (Unicode: U+754C)
Index: 14, Character:   (Unicode: U+0020)
Index: 15, Character: 🌍 (Unicode: U+1F30D)
```

- **注意**：对于 UTF-8 编码的字符（如中文或表情符号），`range` 会按字符而不是字节进行迭代，因此索引值（`i`）指示的是当前字符在字符串中的字节位置。

#### 2. **遍历 `[]byte`**

`[]byte` 是一个字节切片，它的每个元素都是一个字节（`byte`）。当使用 `range` 来遍历 `[]byte` 时，返回的是：

- **索引（`int` 类型）**：当前字节在切片中的索引位置。
- **字节（`byte` 类型）**：切片中的当前字节。

示例：遍历 `[]byte`

```go
byteSlice := []byte("Hello, World!")
for i, b := range byteSlice {
    fmt.Printf("Index: %d, Byte: %d\n", i, b)
}
```

**输出**：

```yaml
Index: 0, Byte: 72
Index: 1, Byte: 101
Index: 2, Byte: 108
Index: 3, Byte: 108
Index: 4, Byte: 111
Index: 5, Byte: 44
Index: 6, Byte: 32
Index: 7, Byte: 87
Index: 8, Byte: 111
Index: 9, Byte: 114
Index: 10, Byte: 108
Index: 11, Byte: 100
Index: 12, Byte: 33
```

- **注意**：对于字节切片，每次迭代得到的是每个字节的整数值。如果你要将字节切片中的字节转换成字符，可以通过转换为 `rune` 类型来处理。

#### 3. **遍历 `rune`**

`rune` 是表示 Unicode 字符的类型，它是 `int32` 的别名。`range` 遍历字符串时返回的每个字符都是 `rune` 类型，所以如果你使用 `range` 遍历一个 `string`，你会得到每个字符的 `rune` 类型。

- 遍历时返回的值

  ：

  - **索引（`int` 类型）**：当前字符在字符串中的字节位置。
  - **字符（`rune` 类型）**：当前字符的 Unicode 码点。

`rune` 类型特别适用于按字符进行遍历时，尤其是在处理包含多字节字符（如中文、表情符号等）的字符串时。

示例：遍历 `rune`

```go
str := "Hello, 世界 🌍"
for i, r := range str {
    fmt.Printf("Index: %d, Rune: %c (Unicode: %U)\n", i, r, r)
}
```

**输出**：

```yaml
Index: 0, Rune: H (Unicode: U+0048)
Index: 1, Rune: e (Unicode: U+0065)
Index: 2, Rune: l (Unicode: U+006C)
Index: 3, Rune: l (Unicode: U+006C)
Index: 4, Rune: o (Unicode: U+006F)
Index: 5, Rune: , (Unicode: U+002C)
Index: 6, Rune:   (Unicode: U+0020)
Index: 7, Rune: 世 (Unicode: U+4E16)
Index: 10, Rune: 界 (Unicode: U+754C)
Index: 14, Rune:   (Unicode: U+0020)
Index: 15, Rune: 🌍 (Unicode: U+1F30D)
```

- **注意**：`rune` 是针对 Unicode 字符的处理，它会自动处理多字节字符（如中文、表情符号等）。因此，遍历时返回的每个字符是 `rune` 类型，它代表字符的 Unicode 码点。

#### 总结：每种类型的遍历涉及到的值

- 遍历 `string`

  ：

  - 返回 **索引**（`int` 类型）和 **字符**（`rune` 类型）。
  - 使用 `range` 时，按字符遍历（即按 Unicode 字符进行迭代），而不是按字节。

- 遍历 `[]byte`

  ：

  - 返回 **索引**（`int` 类型）和 **字节**（`byte` 类型）。
  - 每个字节是一个 ASCII 值，直接处理字节数据。

- 遍历 `rune`

  ：

  - 返回 **索引**（`int` 类型）和 **字符**（`rune` 类型）。
  - `rune` 用于表示单个 Unicode 字符，可以按字符（而不是字节）遍历字符串。

#### 对比表

| 类型     | 遍历时返回的索引        | 遍历时返回的值 | 备注                                |
| -------- | ----------------------- | -------------- | ----------------------------------- |
| `string` | 字节索引（`int`）       | 字符（`rune`） | 按字符遍历，返回字符的 Unicode 码点 |
| `[]byte` | 字节索引（`int`）       | 字节（`byte`） | 按字节遍历，返回每个字节的值        |
| `rune`   | 字符的字节位置（`int`） | 字符（`rune`） | 实际上，`rune` 代表 Unicode 码点    |